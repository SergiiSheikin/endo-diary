<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–©–æ–¥–µ–Ω–Ω–∏–∫ –¥—ñ–∞–±–µ—Ç—É</title>
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#1976d2" />
    <link rel="stylesheet" href="styles.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/3.0.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    <script src="PTSans-Regular-normal.js"></script>
    <script src="PTSans-Bold-bold.js"></script>
    <script src="PTSans-Bold-normal.js"></script>
</head>
<body>
    <header>
        <h1>–©–æ–¥–µ–Ω–Ω–∏–∫ –¥—ñ–∞–±–µ—Ç—É</h1>
        <div class="header-tools">
            <button type="button" id="settings-btn" class="label-btn" title="–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è" onclick="openSettings()">‚öôÔ∏è</button>
            <button type="button" id="theme-toggle" class="label-btn" title="–ó–º—ñ–Ω–∏—Ç–∏ —Ç–µ–º—É">üåô</button>
            <button type="button" id="export-data" class="label-btn" title="–ï–∫—Å–ø–æ—Ä—Ç JSON">–ï–∫—Å–ø–æ—Ä—Ç JSON</button>
            <button type="button" id="import-data" class="label-btn" title="–Ü–º–ø–æ—Ä—Ç JSON">–Ü–º–ø–æ—Ä—Ç JSON</button>
            <input type="file" id="import-file" accept="application/json" style="display:none" />
        </div>
    </header>

    <main>
        <section id="entry-section">
            <h2 class="text-center">–ù–æ–≤–∏–π –∑–∞–ø–∏—Å</h2>
            <form id="entry-form" class="form-column">
                <label title="–î–∞—Ç–∞, –∫–æ–ª–∏ –≤–∏ —Ä–æ–±–∏—Ç–µ –∑–∞–ø–∏—Å">–î–∞—Ç–∞:
                    <input type="date" id="date" required />
                </label>
                <label title="–ß–∞—Å –ø—Ä–∏–π–æ–º—É —ó–∂—ñ –∞–±–æ –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è">–ß–∞—Å:
                    <input type="time" id="time" required />
                </label>
                <label title="–í–∏–±–µ—Ä—ñ—Ç—å –ø—Ä–∏–π–æ–º —ó–∂—ñ (—Å–Ω—ñ–¥–∞–Ω–æ–∫, –æ–±—ñ–¥ —Ç–æ—â–æ)">–ü—Ä–∏–π–æ–º —ó–∂—ñ:
                    <select id="meal"></select>
                </label>
                <label title="–ì—Ä—É–ø–∞ –ø—Ä–æ–¥—É–∫—Ç—É –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –ø–æ—à—É–∫—É">–ì—Ä—É–ø–∞ –ø—Ä–æ–¥—É–∫—Ç—ñ–≤:
                    <select id="group"></select>
                </label>
                <label title="–û–±–µ—Ä—ñ—Ç—å –ø—Ä–æ–¥—É–∫—Ç –∑—ñ —Å–ø–∏—Å–∫—É –∞–±–æ –¥–æ–¥–∞–π—Ç–µ —Å–≤—ñ–π">–ü—Ä–æ–¥—É–∫—Ç:
                    <div class="inline-row">
                        <select id="product"></select>
                        <button type="button" id="add-product" class="label-btn" title="–î–æ–¥–∞—Ç–∏ –Ω–æ–≤–∏–π –ø—Ä–æ–¥—É–∫—Ç —É —Å–ø–∏—Å–æ–∫">Ôºã</button>
                    </div>
                </label>
                <label title="–í–∫–∞–∂—ñ—Ç—å –≤–∞–≥—É –ø—Ä–æ–¥—É–∫—Ç—É –≤ –≥—Ä–∞–º–∞—Ö">–ì—Ä–∞–º–∏ (–≥):
                    <div class="inline-row">
                        <input type="number" id="grams" step="1" />
                        <button type="button" id="add-item" class="label-btn" title="–î–æ–¥–∞—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç —É —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–π–æ–º—É">–î–æ–¥–∞—Ç–∏</button>
                    </div>
                </label>
                <ul id="items-list"></ul>
                
                <label title="–í–∞—à–∞ –≥–ª—é–∫–æ–∑–∞ –ø–µ—Ä–µ–¥ —ó–∂–µ—é (–º–º–æ–ª—å/–ª)">–ì–ª—é–∫–æ–∑–∞ –ø–µ—Ä–µ–¥ —ó–∂–µ—é (–º–º–æ–ª—å/–ª):
                    <input type="number" id="glucose" step="0.1" required />
                </label>
                <label title="–•–ª—ñ–±–Ω—ñ –æ–¥–∏–Ω–∏—Ü—ñ (–•–û) ‚Äî —Å–∫—ñ–ª—å–∫–∏ –•–û —É –≤–∞—à—ñ–π —ó–∂—ñ. 1 –•–û = 10-12 –≥ –≤—É–≥–ª–µ–≤–æ–¥—ñ–≤.">–•–ª—ñ–±–Ω—ñ –æ–¥–∏–Ω–∏—Ü—ñ (–•–û):
                    <input type="number" id="carbs" step="0.1" readonly />
                </label>
                <button type="submit" class="primary-btn" title="–ó–±–µ—Ä–µ–≥—Ç–∏ –∑–∞–ø–∏—Å —ñ —Ä–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ –¥–æ–∑—É —ñ–Ω—Å—É–ª—ñ–Ω—É">–ó–±–µ—Ä–µ–≥—Ç–∏ –π —Ä–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
            </form>
            <div id="recommendation" class="card hidden"></div>
        </section>
        <section id="history-section" class="card" style="margin-top:1.5rem;">
            <h2 class="text-center">–Ü—Å—Ç–æ—Ä—ñ—è –∑–∞ 7 –¥–Ω—ñ–≤</h2>
            <div class="table-scroll">
            <table id="history-table">
                <thead>
                    <tr>
                        <th>–î–∞—Ç–∞</th>
                        <th>–ß–∞—Å</th>
                        <th>–ü—Ä–∏–π–æ–º —ó–∂—ñ</th>
                        <th>–ü—Ä–æ–¥—É–∫—Ç–∏</th>
                        <th>–ì—Ä–∞–º–∏</th>
                        <th>–•–û</th>
                        <th>–ì–ª—é–∫–æ–∑–∞</th>
                        <th>–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç</th>
                        <th>–ö–æ–º–ø–µ–Ω—Å–∞—Ü—ñ—è</th>
                        <th>–Ü–Ω—Å—É–ª—ñ–Ω</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            </div>
            <div id="history-stats" class="card" style="margin-top:1rem;"></div>
        </section>
        <section id="chart-section" class="card" style="margin-top:1.5rem;">
            <h2 class="text-center">–ì—Ä–∞—Ñ—ñ–∫ –≥–ª—é–∫–æ–∑–∏ —Ç–∞ —ñ–Ω—Å—É–ª—ñ–Ω—É (7 –¥–Ω—ñ–≤)</h2>
            <canvas id="chart" height="220"></canvas>
        </section>
    </main>

    <footer>
        <p>–¶—ñ–ª—å–æ–≤–∏–π —Ü—É–∫–æ—Ä: 7 –º–º–æ–ª—å/–ª ‚Ä¢ –ö–æ–µ—Ñ. –≤—É–≥–ª–µ–≤–æ–¥—ñ–≤: 1 –æ–¥/–•–û ‚Ä¢ ISF: 2 –º–º–æ–ª—å/–ª</p>
    </footer>

    <div id="history-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <div id="modal-history-container"></div>
        </div>
    </div>

    <div id="settings-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2>–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —ñ–Ω—Å—É–ª—ñ–Ω—É</h2>
            <form id="settings-form" class="form-column">
                <label title="–¶—ñ–ª—å–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å –≥–ª—é–∫–æ–∑–∏ –≤ –∫—Ä–æ–≤—ñ">–¶—ñ–ª—å–æ–≤–∞ –≥–ª—é–∫–æ–∑–∞ (–º–º–æ–ª—å/–ª):
                    <input type="number" id="target-glucose" step="0.1" min="3" max="15" required />
                </label>
                <label title="–ù–∞ —Å–∫—ñ–ª—å–∫–∏ –º–º–æ–ª—å/–ª –∑–Ω–∏–∂—É—î—Ç—å—Å—è –≥–ª—é–∫–æ–∑–∞ –≤—ñ–¥ 1 –æ–¥–∏–Ω–∏—Ü—ñ —ñ–Ω—Å—É–ª—ñ–Ω—É">–Ü–Ω—Å—É–ª—ñ–Ω-—á—É—Ç–ª–∏–≤—ñ—Å—Ç—å (–Ü–°–§, –º–º–æ–ª—å/–ª):
                    <input type="number" id="isf" step="0.1" min="0.5" max="10" required />
                </label>
                <h3>–ú–Ω–æ–∂–Ω–∏–∫–∏ —ñ–Ω—Å—É–ª—ñ–Ω—É –∑–∞ –ø—Ä–∏–π–æ–º–∞–º–∏ —ó–∂—ñ:</h3>
                <label title="–ú–Ω–æ–∂–Ω–∏–∫ –¥–ª—è —Å–Ω—ñ–¥–∞–Ω–∫—É">–°–Ω—ñ–¥–∞–Ω–æ–∫:
                    <input type="number" id="breakfast-multiplier" step="0.1" min="0.5" max="5" required />
                </label>
                <label title="–ú–Ω–æ–∂–Ω–∏–∫ –¥–ª—è –æ–±—ñ–¥—É">–û–±—ñ–¥:
                    <input type="number" id="lunch-multiplier" step="0.1" min="0.5" max="5" required />
                </label>
                <label title="–ú–Ω–æ–∂–Ω–∏–∫ –¥–ª—è –≤–µ—á–µ—Ä—ñ">–í–µ—á–µ—Ä—è:
                    <input type="number" id="dinner-multiplier" step="0.1" min="0.5" max="5" required />
                </label>
                <label title="–ú–Ω–æ–∂–Ω–∏–∫ –¥–ª—è –ø–µ—Ä–µ–∫—É—Å—ñ–≤">–ü–µ—Ä–µ–∫—É—Å–∏:
                    <input type="number" id="snack-multiplier" step="0.1" min="0.5" max="5" required />
                </label>
                <div class="button-row">
                    <button type="submit" class="primary-btn">–ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</button>
                    <button type="button" id="reset-settings" class="secondary-btn">–°–∫–∏–Ω—É—Ç–∏ –¥–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö</button>
                </div>
            </form>
        </div>
    </div>

    <script type="module" src="app.js"></script>
</body>
</html> 